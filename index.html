<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8"> <!-- idioma -->
<meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- responsive celular -->
<title>FitEngine Pro AI Demo</title>

<!-- Tailwind para dise침o r치pido -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Chart.js para la gr치fica -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>

/* animaci칩n cuando salen cosas */
.fade {
  animation: fade .4s ease;
}

/* keyframes de fade */
@keyframes fade {
  from {opacity:0; transform:translateY(10px);}
  to {opacity:1;}
}

/* cursor clickeable en details */
details summary {
  cursor:pointer;
}

/* cuando abres details se pone amarillo */
details[open] summary {
  color:#eab308;
}

/* ===== TUTORIAL ===== */

/* overlay oscuro que bloquea todo */
.tutorial-overlay {
  position: fixed; /* pegado a pantalla */
  inset: 0; /* top right bottom left 0 */
  background: rgba(0,0,0,0.7); /* oscuro */
  backdrop-filter: blur(8px); /* blur pro */
  z-index: 9999; /* arriba de todo */
  display: flex;
  align-items: flex-end; /* 游댠 lo baja abajo */
  justify-content: center;
  padding: 20px; /* espacio celular */
}

/* caja del tutorial */
.tutorial-box {
  background: #020617; /* negro */
  border: 1px solid #eab308; /* borde amarillo */
  padding: 16px;
  border-radius: 16px;
  width: 100%;
  max-width: 380px; /* m칩vil friendly */
  animation: fade .3s ease;
  margin-bottom: 40px; /* no pegado al borde */
}

/* highlight amarillo en elementos */
.highlight {
  position: relative;
  z-index: 10000;
  box-shadow: 0 0 0 4px rgba(234,179,8,0.8);
  border-radius: 8px;
}

/* ajuste celular */
@media (max-width: 480px) {
  .tutorial-box {
    font-size: 14px;
  }
}

</style>
</head>

<body class="bg-slate-950 text-slate-200 font-sans pb-10">

<!-- ===== NAV ===== -->
<nav class="p-5 bg-slate-900 border-b border-slate-800 flex justify-between sticky top-0 z-50">
<h1 class="text-2xl font-black text-yellow-500">
  FIT<span class="text-white">ENGINE</span> <!-- logo -->
</h1>

<div class="flex gap-3 items-center">
<div class="text-xs bg-yellow-500/10 border border-yellow-500/50 px-3 py-1 rounded-full text-yellow-500 font-bold">
AI SIMULATION MODE
</div>

<!-- bot칩n tutorial -->
<button onclick="startTutorial()" class="text-xs text-yellow-500 underline">
Ver tutorial
</button>
</div>
</nav>

<main class="max-w-6xl mx-auto p-4 space-y-6">

<!-- ===== PANEL INPUT ===== -->
<section id="inputPanel" class="bg-slate-900 p-6 rounded-2xl border border-slate-800">
<h2 class="text-xl font-bold mb-4">Variables de Rendimiento</h2>

<div class="grid md:grid-cols-4 gap-4">

<!-- peso -->
<div id="pesoBox">
<label class="text-xs text-slate-400">Carga</label>
<div class="flex">
<input id="peso" type="number" class="w-full bg-slate-950 border border-slate-700 p-2 rounded-l-lg">
<select id="unit" class="bg-slate-800 border border-slate-700 px-2 rounded-r-lg text-yellow-500 font-bold">
<option value="lbs">LBS</option>
<option value="kg">KG</option>
</select>
</div>
</div>

<!-- reps -->
<div id="repsBox">
<label class="text-xs text-slate-400">Reps</label>
<input id="reps" type="number" min="1" max="15" class="w-full bg-slate-950 border border-slate-700 p-2 rounded-lg">
</div>

<!-- rpe -->
<div id="rpeBox">
<label class="text-xs text-slate-400">RPE (1-10)</label>
<input id="rpe" type="number" min="1" max="10" class="w-full bg-slate-950 border border-slate-700 p-2 rounded-lg">
</div>

<!-- analizar -->
<div class="flex items-end">
<button onclick="procesar()" class="w-full bg-yellow-500 text-black font-black py-3 rounded-lg">
ANALIZAR
</button>
</div>

</div>

<!-- convertir todo -->
<div class="mt-4 flex gap-2">
<button onclick="convertirTodo('kg')" class="bg-green-600 px-3 py-1 rounded text-xs">Convertir todo a KG</button>
<button onclick="convertirTodo('lbs')" class="bg-blue-600 px-3 py-1 rounded text-xs">Convertir todo a LBS</button>
</div>

<!-- resultados -->
<div id="resultado" class="mt-6 grid md:grid-cols-4 gap-4 hidden fade">

<div class="bg-slate-950 p-4 rounded-lg border border-yellow-500/20">
<p class="text-xs text-slate-500">1RM</p>
<h3 id="valor1rm" class="text-xl font-black"></h3>
</div>

<div class="bg-slate-950 p-4 rounded-lg border border-blue-500/20">
<p class="text-xs text-slate-500">RIR</p>
<h3 id="valorRir" class="text-xl font-black text-blue-400"></h3>
</div>

<div class="bg-slate-950 p-4 rounded-lg border border-green-500/20">
<p class="text-xs text-slate-500">Siguiente sesi칩n</p>
<h3 id="prediccion" class="text-xl font-black text-green-400"></h3>
</div>

<div class="bg-slate-950 p-4 rounded-lg border border-purple-500/20">
<p class="text-xs text-slate-500">Meta 1 mes</p>
<h3 id="metaMes" class="text-xl font-black text-purple-400"></h3>
</div>

</div>

<!-- score -->
<div class="mt-4">
<p class="text-xs font-bold">Fitness Score</p>
<div class="bg-slate-800 h-2 rounded">
<div id="scoreBar" class="bg-green-500 h-2 rounded transition-all"></div>
</div>
</div>

<!-- IA -->
<div id="aiPanel" class="mt-4 bg-slate-950 border border-cyan-500/30 p-3 rounded text-cyan-400 text-sm"></div>

</section>

<!-- ===== GRAFICA ===== -->
<section class="bg-slate-900 p-6 rounded-2xl border border-slate-800">
<h2 class="font-bold mb-2">Proyecci칩n Mensual</h2>
<div class="h-64">
<canvas id="myChart"></canvas>
</div>
</section>

</main>

<!-- ===== TUTORIAL POPUP ===== -->
<div id="tutorial" class="hidden tutorial-overlay">
  <div class="tutorial-box">
    <h3 id="tTitle" class="font-black text-yellow-500 text-lg"></h3>
    <p id="tText" class="text-sm text-slate-400 mt-2"></p>
    <button onclick="nextStep()" class="mt-3 bg-yellow-500 text-black px-3 py-1 rounded font-bold w-full">
      Siguiente
    </button>
  </div>
</div>

<script>

// ===== VARIABLES =====
let myChart; // grafica global

// ===== CONVERTIR KG/LBS =====
function convert(p, from, to){
  if(from === to) return p; // si es igual no convierte
  return to === "kg" ? p / 2.20462 : p * 2.20462; // formula
}

// ===== MOTOR PRINCIPAL =====
function procesar(){

  // agarrar valores
  let peso = parseFloat(pesoInput.value);
  let reps = parseInt(repsInput.value);
  let rpe  = parseFloat(rpeInput.value);
  let unit = unitInput.value;

  // validar
  if(!peso || !reps || !rpe) return alert("Completa todo loco");
  if(rpe < 1 || rpe > 10) return alert("RPE es 1-10");

  // convertir a lbs interno
  let pesoLbs = convert(peso, unit, "lbs");

  // formula 1RM
  let oneRM = pesoLbs / (1.0278 - 0.0278 * reps);

  // RIR
  let rir = 10 - rpe;

  // progresi칩n
  let factor = 1.02;
  if(rir >= 4) factor = 1.05;
  if(rir <= 0) factor = 0.95;

  // simulaci칩n mensual
  let datos = [pesoLbs];
  let actual = pesoLbs;
  for(let i=1;i<=4;i++){
    actual *= factor;
    datos.push(actual);
  }

  // score fake
  let score = Math.min(100, Math.round((oneRM/pesoLbs*50) + (reps*2) - (rpe*3)));
  scoreBar.style.width = score + "%";

  // mostrar data
  valor1rm.innerText = Math.round(convert(oneRM,"lbs",unit))+" "+unit;
  valorRir.innerText = rir;
  prediccion.innerText = Math.round(convert(datos[1],"lbs",unit))+" "+unit;
  metaMes.innerText = Math.round(convert(datos[4],"lbs",unit))+" "+unit;

  resultado.classList.remove("hidden");

  actualizarGrafica(datos, unit);
  generarIA(score, rir);
}

// ===== IA FAKE =====
function generarIA(score, rir){
  let msg = "";

  if(score > 80) msg = "Vas duro.";
  else if(score > 50) msg = "Vas bien.";
  else msg = "Progreso flojo.";

  if(rir <= 0) msg += " Est치s al fallo.";
  if(rir >= 4) msg += " Puedes subir peso.";

  aiPanel.innerHTML = "AI Coach: " + msg;
}

// ===== GRAFICA =====
function actualizarGrafica(datos, unit){
  const ctx = myChartCanvas.getContext("2d");
  if(myChart) myChart.destroy();

  myChart = new Chart(ctx, {
    type:"line",
    data:{
      labels:["Hoy","S1","S2","S3","S4"],
      datasets:[{
        data: datos.map(d=>convert(d,"lbs",unit)),
        borderColor:"#eab308",
        backgroundColor:"rgba(234,179,8,0.1)",
        fill:true,
        tension:0.4
      }]
    },
    options:{responsive:true, plugins:{legend:{display:false}}}
  });
}

// ===== REFERENCIAS DOM =====
const pesoInput = peso;
const repsInput = reps;
const rpeInput  = rpe;
const unitInput = unit;
const resultado = document.getElementById("resultado");
const valor1rm  = document.getElementById("valor1rm");
const valorRir  = document.getElementById("valorRir");
const prediccion= document.getElementById("prediccion");
const metaMes   = document.getElementById("metaMes");
const scoreBar  = document.getElementById("scoreBar");
const aiPanel   = document.getElementById("aiPanel");
const myChartCanvas = document.getElementById("myChart");

// ===== TUTORIAL =====
const steps = [
 {el:pesoBox, title:"Carga", text:"Pon el peso que levantaste."},
 {el:repsBox, title:"Repeticiones", text:"Cu치ntas reps hiciste."},
 {el:rpeBox, title:"RPE", text:"Qu칠 tan duro fue del 1 al 10."},
 {el:resultado, title:"Resultados", text:"Aqu칤 salen las m칠tricas."},
 {el:aiPanel, title:"AI Coach", text:"IA que te da consejos."}
];

let stepIndex = 0;

function startTutorial(){
  window.scrollTo({top:0, behavior:"smooth"}); // vuelve arriba
  tutorial.classList.remove("hidden");
  stepIndex = 0;
  showStep();
}

function showStep(){
  document.querySelectorAll(".highlight").forEach(e=>e.classList.remove("highlight"));
  let step = steps[stepIndex];
  if(!step) return endTutorial();
  step.el.classList.add("highlight");
  tTitle.innerText = step.title;
  tText.innerText = step.text;
}

function nextStep(){
  stepIndex++;
  showStep();
}

function endTutorial(){
  tutorial.classList.add("hidden");
  document.querySelectorAll(".highlight").forEach(e=>e.classList.remove("highlight"));
}

// tutorial autom치tico primera vez
window.onload = ()=>{
  actualizarGrafica([0,0,0,0,0],"lbs");
  if(!localStorage.getItem("fitTutorial")){
    startTutorial();
    localStorage.setItem("fitTutorial", true);
  }
};

</script>

</body>
</html>
